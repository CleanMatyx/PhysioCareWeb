{% extends "base.njk" %}

{% block titulo %}<h2>Registrar nuevo expediente médico</h2>{% endblock %}

{% block contenido %}
<form action="/records" method="POST" class="mb-4">
  <div class="form-group mb-3">
    <label>Paciente:</label>
    <select name="patient" class="form-control" required>
      <option value="">-- Selecciona un paciente --</option>
      {% for patient in patients %}
        <option value="{{ patient._id }}" {% if datos.patient == patient._id %}selected{% endif %}>
          {{ patient.name }} {{ patient.surname }}
        </option>
      {% endfor %}
    </select>
  </div>

  <div class="form-group mb-3">
    <label>Expediente médico:</label>
    <textarea name="medicalRecord" class="form-control" rows="5">{{ datos.medicalRecord or '' }}</textarea>
  </div>

  <button type="submit" class="btn btn-primary">Registrar expediente</button>

  {% if error %}
    <div class="alert alert-danger mt-3">{{ error }}</div>
  {% endif %}
</form>
{% endblock %}
